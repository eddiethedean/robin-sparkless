{"name":"array_intersect","pyspark_version":"3.5.0","input":{"schema":[{"name":"id","type":"bigint"},{"name":"s1","type":"string"},{"name":"s2","type":"string"}],"rows":[[1,"a|b|c","b|c|d"],[2,"x|y|y","x|x"]]},"operations":[{"op":"withColumn","column":"a","expr":"split(col('s1'), '|')"},{"op":"withColumn","column":"b","expr":"split(col('s2'), '|')"},{"op":"withColumn","column":"inter","expr":"array_intersect(col('a'), col('b'))"},{"op":"select","columns":["id","a","b","inter"]}],"expected":{"schema":[{"name":"id","type":"bigint"},{"name":"a","type":"array<string>"},{"name":"b","type":"array<string>"},{"name":"inter","type":"array<string>"}],"rows":[[1,["a","b","c"],["b","c","d"],["b","c"]],[2,["x","y","y"],["x","x"],["x"]]]}}