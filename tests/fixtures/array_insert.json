{"name":"array_insert","pyspark_version":"3.5.0","input":{"schema":[{"name":"id","type":"bigint"},{"name":"s","type":"string"},{"name":"pos","type":"int"}],"rows":[[1,"a|c",2],[2,"x|y",1]]},"operations":[{"op":"withColumn","column":"arr","expr":"split(col('s'), '|')"},{"op":"withColumn","column":"inserted","expr":"array_insert(col('arr'), col('pos'), lit('b'))"},{"op":"select","columns":["id","s","pos","arr","inserted"]}],"expected":{"schema":[{"name":"id","type":"bigint"},{"name":"s","type":"string"},{"name":"pos","type":"int"},{"name":"arr","type":"array<string>"},{"name":"inserted","type":"array<string>"}],"rows":[[1,"a|c",2,["a","|","c",""],["a","b","|","c",""]],[2,"x|y",1,["x","|","y",""],["b","x","|","y",""]]]}}
