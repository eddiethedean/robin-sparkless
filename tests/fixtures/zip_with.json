{"name":"zip_with","pyspark_version":"3.5.0","input":{"schema":[{"name":"id","type":"bigint"},{"name":"s1","type":"string"},{"name":"s2","type":"string"}],"rows":[[1,"1|2|3","10|20"],[2,"5","50|60"]]},"operations":[{"op":"withColumn","column":"a","expr":"split(col('s1'), '|')"},{"op":"withColumn","column":"b","expr":"split(col('s2'), '|')"},{"op":"withColumn","column":"zipped","expr":"zip_with(col('a'), col('b'), coalesce(col(\"\").struct_().field_by_name(\"left\"), col(\"\").struct_().field_by_name(\"right\")))"},{"op":"select","columns":["id","a","b","zipped"]}],"expected":{"schema":[{"name":"id","type":"bigint"},{"name":"a","type":"array<string>"},{"name":"b","type":"array<string>"},{"name":"zipped","type":"array<string>"}],"rows":[[1,["1","2","3"],["10","20"],["1","2","3"]],[2,["5"],["50","60"],["5","60"]]]}}